<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - LabEquip</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        
        .background-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; }
        .background-container::before { content: ''; position: absolute; width: 100%; height: 100%; background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="flask" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" fill="rgba(255,255,255,0.1)"/><path d="M8 15 L12 15 L11 18 L9 18 Z" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23flask)"/></svg>'); animation: float 20s infinite linear; }
        @keyframes float { 0% { transform: translate(0, 0); } 100% { transform: translate(-20px, -20px); } }

        .header { background: rgba(255, 255, 255, 0.95); padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 15px; }
        .logo i { font-size: 2rem; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .logo h1 { background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 1.8rem; }
        .admin-badge { background: #dc3545; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; }
        .user-info { display: flex; align-items: center; gap: 15px; }
        .user-avatar { width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }

        .nav-container { background: rgba(255, 255, 255, 0.9); margin: 1rem 2rem; border-radius: 15px; padding: 1rem; }
        .nav-tabs { display: flex; gap: 10px; list-style: none; }
        .nav-tabs a { padding: 12px 24px; text-decoration: none; color: #666; border-radius: 10px; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; }
        .nav-tabs a.active, .nav-tabs a:hover { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }

        .admin-container { padding: 0 2rem 2rem 2rem; }
        .admin-header { background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 2rem; margin-bottom: 2rem; }
        
        .admin-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 2rem 0; }
        .stat-card { background: rgba(255, 255, 255, 0.95); padding: 1.5rem; border-radius: 15px; text-align: center; transition: transform 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-card i { font-size: 2.5rem; margin-bottom: 1rem; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .stat-number { font-size: 2rem; font-weight: bold; color: #333; }
        .stat-label { color: #666; font-size: 0.9rem; }

        .admin-tabs { display: flex; gap: 10px; margin-bottom: 2rem; flex-wrap: wrap; }
        .admin-tab { padding: 12px 24px; background: #f8f9fa; border: none; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; }
        .admin-tab.active { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }

        .admin-tab-content { display: none; }
        .admin-tab-content.active { display: block; }

        .admin-table { background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 1.5rem; margin-bottom: 2rem; }
        .table-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f9fa; font-weight: 600; }
        tr:hover { background: #f8f9fa; }

        .btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; transition: all 0.3s ease; margin: 2px; }
        .btn-sm { padding: 6px 12px; font-size: 0.8rem; }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: #212529; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-info { background: #17a2b8; color: white; }
        .btn:hover { transform: translateY(-2px); }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 2rem; border-radius: 15px; width: 90%; max-width: 500px; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 8px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }

        .status-available { color: #28a745; font-weight: bold; }
        .status-maintenance { color: #ffc107; font-weight: bold; }
        .status-reserved { color: #dc3545; font-weight: bold; }
        .status-pending { color: #6c757d; font-weight: bold; }
        .status-approved { color: #28a745; font-weight: bold; }
    </style>

    <!-- Authentication Script -->
    <script>
        // Admin access control
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const session = localStorage.getItem('currentSession');
            if (!session) {
                window.location.href = 'index.html';
                return;
            }

            // Check if user is admin
            const user = JSON.parse(session).user;
            if (user.role !== 'admin') {
                // Show access denied message
                document.querySelector('.admin-container').innerHTML = `
                    <div style="text-align: center; color: white; padding: 4rem;">
                        <i class="fas fa-lock" style="font-size: 4rem; margin-bottom: 1rem;"></i>
                        <h2>Access Denied</h2>
                        <p>Administrator privileges required to access this page.</p>
                        <a href="dashboard.html" style="color: white; text-decoration: underline;">Return to Dashboard</a>
                    </div>
                `;
                return;
            }
            
            // If user is admin, show their info
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userRole').textContent = 'Administrator';
            document.getElementById('userAvatar').textContent = user.name.charAt(0).toUpperCase();
        });

        // Logout function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('currentSession');
                window.location.href = 'index.html';
            }
        }
    </script>
</head>
<body>
    <div class="background-container"></div>

    <header class="header">
        <div class="logo">
            <i class="fas fa-cogs"></i>
            <h1>Admin Panel <span class="admin-badge">ADMIN</span></h1>
        </div>
        <div class="user-info">
            <div class="user-avatar" id="userAvatar">A</div>
            <div>
                <div id="userName">Admin User</div>
                <div id="userRole" style="font-size: 0.8rem; color: #666;">Administrator</div>
            </div>
        </div>
    </header>

    <nav class="nav-container">
        <ul class="nav-tabs">
            <li><a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
            <li><a href="equipment.html"><i class="fas fa-search"></i> Equipment</a></li>
            <li><a href="bookings.html"><i class="fas fa-history"></i> Bookings</a></li>
            <li><a href="admin.html" class="active"><i class="fas fa-cog"></i> Admin Panel</a></li>
            <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
        </ul>
    </nav>

    <main class="admin-container">
        <div class="admin-header">
            <h2>⚙️ Laboratory Administration</h2>
            <p>Manage equipment, users, bookings, and system settings</p>
        </div>

        <div class="admin-stats">
            <div class="stat-card">
                <i class="fas fa-microscope"></i>
                <div class="stat-number" id="totalEquipment">0</div>
                <div class="stat-label">Total Equipment</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <div class="stat-number" id="totalUsers">0</div>
                <div class="stat-label">Registered Users</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-calendar-check"></i>
                <div class="stat-number" id="activeBookings">0</div>
                <div class="stat-label">Active Bookings</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-tools"></i>
                <div class="stat-number" id="maintenanceCount">0</div>
                <div class="stat-label">Maintenance</div>
            </div>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="showTab('equipment')">Equipment Management</button>
            <button class="admin-tab" onclick="showTab('users')">User Management</button>
            <button class="admin-tab" onclick="showTab('bookings')">Booking Approvals</button>
            <button class="admin-tab" onclick="showTab('maintenance')">Maintenance</button>
        </div>

        <!-- Equipment Management -->
        <div id="equipment-tab" class="admin-tab-content active">
            <div class="table-header">
                <h3>Equipment Inventory</h3>
                <button class="btn btn-primary" onclick="showModal('equipmentModal')">
                    <i class="fas fa-plus"></i> Add Equipment
                </button>
            </div>
            <div class="admin-table">
                <table>
                    <thead>
                        <tr><th>ID</th><th>Name</th><th>Type</th><th>Status</th><th>Location</th><th>Actions</th></tr>
                    </thead>
                    <tbody id="equipmentTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- User Management -->
        <div id="users-tab" class="admin-tab-content">
            <div class="table-header">
                <h3>User Management</h3>
                <button class="btn btn-primary" onclick="showModal('userModal')">
                    <i class="fas fa-user-plus"></i> Add User
                </button>
            </div>
            <div class="admin-table">
                <table>
                    <thead>
                        <tr><th>ID</th><th>Name</th><th>Email</th><th>Role</th><th>Status</th><th>Actions</th></tr>
                    </thead>
                    <tbody id="usersTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- Booking Approvals -->
        <div id="bookings-tab" class="admin-tab-content">
            <div class="table-header">
                <h3>Pending Booking Approvals</h3>
            </div>
            <div class="admin-table">
                <table>
                    <thead>
                        <tr><th>Booking ID</th><th>User</th><th>Equipment</th><th>Date</th><th>Status</th><th>Actions</th></tr>
                    </thead>
                    <tbody id="bookingsTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- Maintenance -->
        <div id="maintenance-tab" class="admin-tab-content">
            <div class="table-header">
                <h3>Maintenance Schedule</h3>
                <button class="btn btn-primary" onclick="showModal('maintenanceModal')">
                    <i class="fas fa-calendar-plus"></i> Schedule Maintenance
                </button>
            </div>
            <div class="admin-table">
                <table>
                    <thead>
                        <tr><th>Equipment</th><th>Issue</th><th>Reported</th><th>Priority</th><th>Status</th><th>Actions</th></tr>
                    </thead>
                    <tbody id="maintenanceTableBody"></tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Equipment Modal -->
    <div id="equipmentModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-microscope"></i> Add New Equipment</h3>
            <form id="equipmentForm" onsubmit="addEquipment(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>Equipment Name</label>
                        <input type="text" id="equipName" required>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="equipType" required>
                            <option value="">Select Type</option>
                            <option value="microscope">Microscope</option>
                            <option value="centrifuge">Centrifuge</option>
                            <option value="spectrometer">Spectrometer</option>
                            <option value="incubator">Incubator</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="equipLocation" required>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="equipStatus" required>
                            <option value="available">Available</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="reserved">Reserved</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Specifications</label>
                    <textarea id="equipSpecs" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-success">Add Equipment</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Sample Data
        let equipmentData = [
            { id: 1, name: "Digital Microscope", type: "microscope", status: "available", location: "Biology Lab", specs: "1000x magnification" },
            { id: 2, name: "High-Speed Centrifuge", type: "centrifuge", status: "maintenance", location: "Chemistry Lab", specs: "Max 6000 RPM" },
            { id: 3, name: "UV-Vis Spectrometer", type: "spectrometer", status: "available", location: "Physics Lab", specs: "200-800 nm range" }
        ];

        let usersData = [
            { id: 1, name: "John Smith", email: "john@university.edu", role: "Student", status: "Active" },
            { id: 2, name: "Dr. Sarah Johnson", email: "s.johnson@university.edu", role: "Professor", status: "Active" },
            { id: 3, name: "Admin User", email: "admin@university.edu", role: "Administrator", status: "Active" }
        ];

        let bookingsData = [
            { id: 1, user: "John Smith", equipment: "Digital Microscope", date: "2024-01-20", status: "pending" },
            { id: 2, user: "Dr. Sarah Johnson", equipment: "UV-Vis Spectrometer", date: "2024-01-21", status: "pending" }
        ];

        let maintenanceData = [
            { id: 1, equipment: "High-Speed Centrifuge", issue: "Motor calibration needed", reported: "2024-01-15", priority: "High", status: "In Progress" }
        ];

        // Initialize Admin Panel
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            loadEquipmentTable();
            loadUsersTable();
            loadBookingsTable();
            loadMaintenanceTable();
        });

        // Tab Management
        function showTab(tabName) {
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // Modal Management
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }

        // Update Statistics
        function updateStats() {
            document.getElementById('totalEquipment').textContent = equipmentData.length;
            document.getElementById('totalUsers').textContent = usersData.length;
            document.getElementById('activeBookings').textContent = bookingsData.length;
            document.getElementById('maintenanceCount').textContent = maintenanceData.length;
        }

        // Equipment Management
        function loadEquipmentTable() {
            const tbody = document.getElementById('equipmentTableBody');
            tbody.innerHTML = equipmentData.map(equip => `
                <tr>
                    <td>EQ${equip.id.toString().padStart(3, '0')}</td>
                    <td>${equip.name}</td>
                    <td>${equip.type}</td>
                    <td class="status-${equip.status}">${equip.status.charAt(0).toUpperCase() + equip.status.slice(1)}</td>
                    <td>${equip.location}</td>
                    <td>
                        <button class="btn btn-sm btn-warning" onclick="editEquipment(${equip.id})">Edit</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteEquipment(${equip.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function addEquipment(event) {
            event.preventDefault();
            const newEquip = {
                id: equipmentData.length + 1,
                name: document.getElementById('equipName').value,
                type: document.getElementById('equipType').value,
                location: document.getElementById('equipLocation').value,
                status: document.getElementById('equipStatus').value,
                specs: document.getElementById('equipSpecs').value
            };
            
            equipmentData.push(newEquip);
            loadEquipmentTable();
            updateStats();
            closeModal();
            document.getElementById('equipmentForm').reset();
            alert('Equipment added successfully!');
        }

        function editEquipment(id) {
            const equip = equipmentData.find(e => e.id === id);
            if (equip) {
                document.getElementById('equipName').value = equip.name;
                document.getElementById('equipType').value = equip.type;
                document.getElementById('equipLocation').value = equip.location;
                document.getElementById('equipStatus').value = equip.status;
                document.getElementById('equipSpecs').value = equip.specs;
                showModal('equipmentModal');
            }
        }

        function deleteEquipment(id) {
            if (confirm('Are you sure you want to delete this equipment?')) {
                equipmentData = equipmentData.filter(e => e.id !== id);
                loadEquipmentTable();
                updateStats();
                alert('Equipment deleted successfully!');
            }
        }

        // User Management
        function loadUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = usersData.map(user => `
                <tr>
                    <td>U${user.id.toString().padStart(3, '0')}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.role}</td>
                    <td class="status-${user.status.toLowerCase()}">${user.status}</td>
                    <td>
                        <button class="btn btn-sm btn-warning">Edit</button>
                        <button class="btn btn-sm btn-info">Reset Pass</button>
                    </td>
                </tr>
            `).join('');
        }

        // Booking Management
        function loadBookingsTable() {
            const tbody = document.getElementById('bookingsTableBody');
            tbody.innerHTML = bookingsData.map(booking => `
                <tr>
                    <td>B${booking.id.toString().padStart(3, '0')}</td>
                    <td>${booking.user}</td>
                    <td>${booking.equipment}</td>
                    <td>${booking.date}</td>
                    <td class="status-${booking.status}">${booking.status.charAt(0).toUpperCase() + booking.status.slice(1)}</td>
                    <td>
                        <button class="btn btn-sm btn-success" onclick="approveBooking(${booking.id})">Approve</button>
                        <button class="btn btn-sm btn-danger" onclick="rejectBooking(${booking.id})">Reject</button>
                    </td>
                </tr>
            `).join('');
        }

        function approveBooking(id) {
            const booking = bookingsData.find(b => b.id === id);
            booking.status = 'approved';
            loadBookingsTable();
            alert(`Booking #B${id.toString().padStart(3, '0')} approved!`);
        }

        function rejectBooking(id) {
            if (confirm('Reject this booking request?')) {
                bookingsData = bookingsData.filter(b => b.id !== id);
                loadBookingsTable();
                updateStats();
                alert('Booking rejected!');
            }
        }

        // Maintenance Management
        function loadMaintenanceTable() {
            const tbody = document.getElementById('maintenanceTableBody');
            tbody.innerHTML = maintenanceData.map(maint => `
                <tr>
                    <td>${maint.equipment}</td>
                    <td>${maint.issue}</td>
                    <td>${maint.reported}</td>
                    <td>${maint.priority}</td>
                    <td>${maint.status}</td>
                    <td>
                        <button class="btn btn-sm btn-success" onclick="completeMaintenance(${maint.id})">Complete</button>
                    </td>
                </tr>
            `).join('');
        }

        function completeMaintenance(id) {
            if (confirm('Mark this maintenance as completed?')) {
                maintenanceData = maintenanceData.filter(m => m.id !== id);
                loadMaintenanceTable();
                updateStats();
                alert('Maintenance completed!');
            }
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                closeModal();
            }
        });
    </script>
</body>
</html>